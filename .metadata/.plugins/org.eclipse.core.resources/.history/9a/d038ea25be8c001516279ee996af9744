/*
 * main.cpp
 *
 *  Created on: 16 de nov. de 2015
 *      Author: santiago
 */
#include <iostream>
#include <stdio.h>
#include <string.h>
#include <fstream>
#include <stdlib.h>

using namespace std;

class Pagina{
	public:
		Pagina** paginas;
		int sizeAlfabeto;
		char* obj;
	Pagina(){

	}

	Pagina(int size){
		this->sizeAlfabeto = size;
		obj = 0;
		paginas = new Pagina*[size];
		for(int i = 0; i< size; i++){
			paginas[i] = 0;
		}
	}
	void printDot(ofstream& os)
	{

		for(int i = 0 ; i<sizeAlfabeto; i++){
			if(paginas[i]){
				os<<"\""<<this<<"\""<<"->"<<"\""<<paginas[i]<<"\""<<endl;
				}
			}
		}

};

class Digital
{
	public:
	Pagina* raiz;
	int size;
	Digital(int size){
		this->size = size;
		raiz = 0;
	}

	void Add(char dato[]){
		Pagina * q;
		if(Find(dato, q)){
			return;
		}
		if(!raiz){
			raiz = q;
		}
		for(int i = 0; i < strlen(dato);i++){
			Pagina * p = new Pagina(size);
			q->paginas[(int)(dato[i])-(int)'a']= p;
			q = p;
			if(i == strlen(dato)-1){
				q->obj = dato;
			}
		}

	}

	bool Find(char dato[], Pagina * & q){
		if(!raiz){
			q = new Pagina(size);
			return false;
		}
		for(int i = 0; i < strlen(dato);i++){
			if(q->paginas[(int)(dato[i])-(int)'a']){
				q = q->paginas[(int)(dato[i])-(int)'a'];
			}else{
				return false;
			}

		}
		return true;
	}

	void printDot(char* p)
	{
		ofstream file(p);
		file<<"digraph {"<<endl;
		file<<"\""<<raiz <<"\""<<"[shape=record, label=\"{ 1 | 2 | 3}  \"];"<<endl;
		raiz->printDot(file);
		file<<" }"<<endl;
	}

};



int main()
{
	Digital dig(26);
	dig.Add("perro");
	dig.printDot("archivo.dot");
	system("dot -Tpng archivo.dot -o archivo.png");
	//Pagina<int> Pagina(10);
	cout<<"aaa"<<endl;

 return 0;
}
